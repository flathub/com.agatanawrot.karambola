app-id: com.agatanawrot.karambola
base: org.electronjs.Electron2.BaseApp
base-version: '21.08'
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: com.agatanawrot.karambola
separate-locales: false
finish-args:
  - --device=dri
  - --share=ipc
  - --share=network
  - --socket=pulseaudio
  - --socket=x11
modules:
  - name: karambola
    buildsystem: simple

    sources:
      - type: archive
        url: https://holypangolin.com/stuff/karambola/1.6.0/karambola-1.6.0-linux-amd64.tar.gz
        sha256: 2a33887dc1ebf67285f4c831c25a00df0e8bc9232952710926c50d614aa25f4a
        only-arches:
          - x86_64
      - type: archive
        url: https://holypangolin.com/stuff/karambola/1.6.0/karambola-1.6.0-linux-arm64.tar.gz
        sha256: 5fb3d080a7bdc6b99c5b7dcb9f51f3fc0b192987cbc7160422d0fc22079a3219
        only-arches:
          - aarch64
      - type: script
        dest-filename: com.agatanawrot.karambola
        commands:
          - zypak-wrapper.sh /app/bin/karambola "$@"

    build-commands:
      - install -Dm644 -t /app/share/metainfo resources/app/com.agatanawrot.karambola.metainfo.xml
      - install -Dm644 -t /app/share/applications resources/app/com.agatanawrot.karambola.desktop
      - install -Dm644 resources/app/karambola-64.png /app/share/icons/hicolor/64x64/apps/com.agatanawrot.karambola.png
      - install -Dm644 resources/app/karambola-128.png /app/share/icons/hicolor/128x128/apps/com.agatanawrot.karambola.png
      - install -Dm644 resources/app/karambola-256.png /app/share/icons/hicolor/256x256/apps/com.agatanawrot.karambola.png
      - install -Dm644 resources/app/karambola.png /app/share/icons/hicolor/512x512/apps/com.agatanawrot.karambola.png
      - mv * /app/bin
      - desktop-file-edit --set-key Exec --set-value com.agatanawrot.karambola /app/share/applications/com.agatanawrot.karambola.desktop
